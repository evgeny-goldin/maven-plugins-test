<?xml version="1.0" encoding="UTF-8"?>

<project xmlns              = "http://maven.apache.org/POM/4.0.0"
         xmlns:xsi          = "http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation = "http://maven.apache.org/POM/4.0.0
                               http://maven.apache.org/maven-v4_0_0.xsd">

    <modelVersion>4.0.0</modelVersion>
    <groupId>com.goldin.plugins.maven-plugins-test</groupId>
    <artifactId>maven-copy-plugin.issues.0.2.3.5</artifactId>
    <packaging>jar</packaging>
    <version>0.1-SNAPSHOT</version>
    <name>[${project.groupId}:${project.artifactId}:${project.version}]</name>


    <parent>
        <groupId>com.goldin.plugins.maven-plugins-test</groupId>
        <artifactId>maven-copy-plugin.issues</artifactId>
        <version>0.1-SNAPSHOT</version>
    </parent>


    <properties>
        <resourcesDir>${project.basedir}/../../copy-mojo/src/main/resources</resourcesDir>

        <!-- http://evgeny-goldin.org/youtrack/issue/pl-516 -->
        <processAssert>
        {{
            assert files.size()    == 4
            assert file            == files.first()
            assert file.name       == '0.txt'
            assert files[ 0 ].name == '0.txt'
            assert files[ 1 ].name == '1.txt'
            assert files[ 2 ].name == '2.txt'
            assert files[ 3 ].name == '3.txt'
        }}
        </processAssert>
    </properties>


    <build>
        <plugins>
            <plugin>
                <groupId>com.goldin.plugins</groupId>
                <artifactId>maven-copy-plugin</artifactId>
                <version>${plugins-version}</version>
                <executions>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-516                        -->
                    <!-- "Order of files is not kept when "files" list is passed to <process>" -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-516</id>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <phase>initialize</phase>
                        <configuration>
                            <resources>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/1</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileName>0.txt</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/1</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileName>1.txt</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/1</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileName>2.txt</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/1</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileName>3.txt</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/2</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <includes>
                                        <include>0.txt</include>
                                        <include>1.txt</include>
                                        <include>2.txt</include>
                                        <include>3.txt</include>
                                    </includes>
                                    <process>${processAssert}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/2</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <includes>
                                        <include>3.txt</include>
                                        <include>1.txt</include>
                                        <include>0.txt</include>
                                        <include>2.txt</include>
                                    </includes>
                                    <process>${processAssert}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/2</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <includes>
                                        <include>3.txt</include>
                                        <include>2.txt</include>
                                        <include>1.txt</include>
                                        <include>0.txt</include>
                                    </includes>
                                    <process>${processAssert}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/3</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <include>0.txt, 1.txt, 2.txt, 3.txt</include>
                                    <process>${processAssert}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/3</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <include>3.txt, 1.txt, 2.txt, 0.txt</include>
                                    <process>${processAssert}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-516/3</targetPath>
                                    <directory>${outputDir}/pl-516/1</directory>
                                    <include>3.txt, 2.txt, 1.txt, 0.txt</include>
                                    <process>${processAssert}</process>
                                </resource>
                            </resources>
                        </configuration>
                    </execution>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-513                        -->
                    <!-- "Support <destFilePrefix>, <destFileSuffix>, and <destFileExtension>" -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-513</id>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <phase>initialize</phase>
                        <configuration>
                            <resources>
                                <!-- ~~~~~~~~~~~~~ -->
                                <!-- Copying files -->
                                <!-- ~~~~~~~~~~~~~ -->
                                <resource>
                                    <targetPath>${outputDir}/pl-513/1</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileName>1-pom-1.xml</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/2</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFilePrefix>2-</destFilePrefix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/3</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileSuffix>-3</destFileSuffix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/4</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileExtension>4</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/5</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFilePrefix>5-</destFilePrefix>
                                    <destFileSuffix>-5</destFileSuffix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/6</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFileSuffix>-6</destFileSuffix>
                                    <destFileExtension>6</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/7</targetPath>
                                    <file>${project.basedir}/pom.xml</file>
                                    <destFilePrefix>7-</destFilePrefix>
                                    <destFileSuffix>-7</destFileSuffix>
                                    <destFileExtension>7</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/8</targetPath>
                                    <directory>${resourcesDir}</directory>
                                    <preservePath>true</preservePath>
                                    <filter>{{ files.findAll{ it.name.endsWith( '.txt' ) }}}</filter>
                                    <destFilePrefix>8-</destFilePrefix>
                                    <destFileSuffix>-8</destFileSuffix>
                                    <destFileExtension>8</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/9</targetPath>
                                    <directory>${resourcesDir}</directory>
                                    <preservePath>true</preservePath>
                                    <filter>{{ files.findAll{ ! it.name.endsWith( '.txt' ) }}}</filter>
                                    <destFilePrefix>9-</destFilePrefix>
                                    <destFileSuffix>-9</destFileSuffix>
                                </resource>
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <!-- Copying files with structure -->
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <resource>
                                    <targetPath>${outputDir}/pl-513/10</targetPath>
                                    <dependency>
                                        <groupId>com.jcraft</groupId>
                                        <artifactId>jsch</artifactId>
                                        <version>0.1.38</version>
                                    </dependency>
                                    <unpack>true</unpack>
                                    <process>{{ files.findAll{ it.name.endsWith( '.MF' ) }.first().delete() }}</process>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/11</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <destFilePrefix>11-</destFilePrefix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/12</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <destFileSuffix>-12</destFileSuffix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/13</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <destFilePrefix>13-</destFilePrefix>
                                    <destFileSuffix>-13</destFileSuffix>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/14</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <destFilePrefix>14-</destFilePrefix>
                                    <destFileSuffix>-14</destFileSuffix>
                                    <destFileExtension>14</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/15</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <destFilePrefix>15-</destFilePrefix>
                                    <destFileSuffix>-15</destFileSuffix>
                                    <destFileExtension>15</destFileExtension>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-513/16</targetPath>
                                    <directory>${outputDir}/pl-513/10</directory>
                                    <verbose>false</verbose>
                                    <destFileName>destFileName</destFileName>
                                    <destFilePrefix>16-</destFilePrefix>
                                    <destFileSuffix>-16</destFileSuffix>
                                    <destFileExtension>16</destFileExtension>
                                </resource>
                            </resources>
                        </configuration>
                    </execution>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-493                    -->
                    <!-- "Avoid unpacking files that have been unpacked by a previous run" -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-493-1</id>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <phase>initialize</phase>
                        <configuration>
                            <skipUnpacked>true</skipUnpacked>
                            <resources>
                                <resource>
                                    <description>unpack-groovy-1</description>
                                    <targetPath>${outputDir}/pl-493/unpack</targetPath>
                                    <dependency>
                                        <groupId>org.codehaus.groovy</groupId>
                                        <artifactId>groovy-all</artifactId>
                                        <version>1.9.0-beta-4</version>
                                    </dependency>
                                    <dependenciesAtM2>true</dependenciesAtM2>
                                    <unpack>true</unpack>
                                    <process>{{ assert files.size() == 3759 }}</process>
                                </resource>
                                <resource>
                                    <description>unpack-groovy-2</description>
                                    <targetPath>${outputDir}/pl-493/unpack</targetPath>
                                    <dependency>
                                        <groupId>org.codehaus.groovy</groupId>
                                        <artifactId>groovy-all</artifactId>
                                        <version>1.9.0-beta-4</version>
                                    </dependency>
                                    <dependenciesAtM2>true</dependenciesAtM2>
                                    <unpack>true</unpack>
                                    <process>{{ assert (( files.size() == 0 ) &amp;&amp; ( file == null )) }}</process>
                                </resource>
                            </resources>
                        </configuration>
                    </execution>
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-493-2</id>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <phase>initialize</phase>
                        <configuration>
                            <resource>
                                <description>unpack-groovy-3</description>
                                <targetPath>${outputDir}/pl-493/unpack</targetPath>
                                <dependency>
                                    <groupId>org.codehaus.groovy</groupId>
                                    <artifactId>groovy-all</artifactId>
                                    <version>1.9.0-beta-4</version>
                                </dependency>
                                <dependenciesAtM2>true</dependenciesAtM2>
                                <skipUnpacked>true</skipUnpacked>
                                <unpack>true</unpack>
                                <process>{{ assert (( files.size() == 0 ) &amp;&amp; ( file == null )) }}</process>
                            </resource>
                        </configuration>
                    </execution>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-502:                   -->
                    <!-- "Treat <nonFilteredExtensions> for non-replaceable files as well" -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-502</id>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <phase>initialize</phase>
                        <configuration>
                            <resources>
                                <resource>
                                    <targetPath>${outputDir}/pl-502</targetPath>
                                    <dependency>
                                        <groupId>org.codehaus.groovy</groupId>
                                        <artifactId>groovy-all</artifactId>
                                        <version>1.8.3</version>
                                    </dependency>
                                    <destFileName>groovy-all.jar</destFileName>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/1</targetPath>
                                    <file>${outputDir}/pl-502/groovy-all.jar</file>
                                    <unpack>true</unpack>
                                </resource>
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <!-- Copying with and without replaces -->
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <resource>
                                    <targetPath>${outputDir}/pl-502/copy-1</targetPath>
                                    <directory>${outputDir}/pl-502/1</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/copy-2</targetPath>
                                    <directory>${outputDir}/pl-502/1</directory>
                                    <verbose>false</verbose>
                                    <preservePath>true</preservePath>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                    <nonFilteredExtensions>class, xml</nonFilteredExtensions>
                                </resource>
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <!-- Unpacking with and without replaces -->
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <resource>
                                    <targetPath>${outputDir}/pl-502/unpack-1</targetPath>
                                    <file>${outputDir}/pl-502/groovy-all.jar</file>
                                    <unpack>true</unpack>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/unpack-2</targetPath>
                                    <file>${outputDir}/pl-502/groovy-all.jar</file>
                                    <unpack>true</unpack>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                    <nonFilteredExtensions>class, xml</nonFilteredExtensions>
                                </resource>
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <!-- Packing with and without replaces -->
                                <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                                <resource>
                                    <targetPath>${outputDir}/pl-502/pack-1/groovy-all.jar</targetPath>
                                    <directory>${outputDir}/pl-502/1</directory>
                                    <pack>true</pack>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/pack-1/unpack</targetPath>
                                    <file>${outputDir}/pl-502/pack-1/groovy-all.jar</file>
                                    <unpack>true</unpack>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/pack-2/groovy-all.jar</targetPath>
                                    <directory>${outputDir}/pl-502/1</directory>
                                    <pack>true</pack>
                                    <replace>
                                        <from>.</from>
                                        <to>!</to>
                                    </replace>
                                    <nonFilteredExtensions>class, xml</nonFilteredExtensions>
                                </resource>
                                <resource>
                                    <targetPath>${outputDir}/pl-502/pack-2/unpack</targetPath>
                                    <file>${outputDir}/pl-502/pack-2/groovy-all.jar</file>
                                    <unpack>true</unpack>
                                </resource>
                            </resources>
                        </configuration>
                    </execution>
                </executions>
            </plugin>

            <plugin>
                <groupId>com.goldin.plugins</groupId>
                <artifactId>maven-assert-plugin</artifactId>
                <version>${plugins-version}</version>
                <executions>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-516 -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-516</id>
                        <goals>
                            <goal>assert</goal>
                        </goals>
                        <phase>test</phase>
                        <configuration>
                            <assertFiles>
                                ${outputDir}/pl-516/1/*.txt
                                ${outputDir}/pl-516/1/0.txt
                                ${outputDir}/pl-516/1/1.txt
                                ${outputDir}/pl-516/1/2.txt
                                ${outputDir}/pl-516/1/3.txt

                                ${outputDir}/pl-516/2/*.txt
                                ${outputDir}/pl-516/2/0.txt
                                ${outputDir}/pl-516/2/1.txt
                                ${outputDir}/pl-516/2/2.txt
                                ${outputDir}/pl-516/2/3.txt

                                ${outputDir}/pl-516/3/*.txt
                                ${outputDir}/pl-516/3/0.txt
                                ${outputDir}/pl-516/3/1.txt
                                ${outputDir}/pl-516/3/2.txt
                                ${outputDir}/pl-516/3/3.txt
                            </assertFiles>
                            <assertEqual>
                                ${outputDir}/pl-516/1|${outputDir}/pl-516/2
                                ${outputDir}/pl-516/2|${outputDir}/pl-516/3
                                ${outputDir}/pl-516/3|${outputDir}/pl-516/1
                            </assertEqual>
                        </configuration>
                    </execution>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-513 -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-513</id>
                        <goals>
                            <goal>assert</goal>
                        </goals>
                        <phase>test</phase>
                        <configuration>
                            <assertFiles>
                                ${outputDir}/pl-513/1/1-pom-1.xml
                                ${outputDir}/pl-513/2/2-pom.xml
                                ${outputDir}/pl-513/3/pom-3.xml
                                ${outputDir}/pl-513/4/pom.4
                                ${outputDir}/pl-513/5/5-pom-5.xml
                                ${outputDir}/pl-513/6/pom-6.6
                                ${outputDir}/pl-513/7/7-pom-7.7
                                ${outputDir}/pl-513/8/8-1-8.8
                                ${outputDir}/pl-513/8/8-2-8.8
                                ${outputDir}/pl-513/8/8-3-8.8
                                ${outputDir}/pl-513/8/8-4-8.8
                                ${outputDir}/pl-513/8/8-ftp-exclude-8.8
                                ${outputDir}/pl-513/8/8-ftp-include-8.8
                                ${outputDir}/pl-513/9/9-1-9
                                ${outputDir}/pl-513/9/9-2-9
                                ${outputDir}/pl-513/9/9-3-9
                                ${outputDir}/pl-513/9/9-4-9
                                ${outputDir}/pl-513/9/9-ftp-exclude-9
                                ${outputDir}/pl-513/9/9-ftp-include-9
                                ${outputDir}/pl-513/16/destFileName
                            </assertFiles>
                            <assertGroovy>
                                new File( outputDir, 'pl-513/8' ).directorySize() == 69
                                new File( outputDir, 'pl-513/9' ).directorySize() == 69
                                new File( outputDir, 'pl-513/8' ).directorySize() == new File( outputDir, 'pl-513/9'  ).directorySize()

                                [ 10, 11, 12, 13, 14 ].every{ new File( outputDir, "pl-513/$it" ).directorySize() == 302093 }
                                new File( outputDir, 'pl-513/15' ).directorySize() == 294372

                                null == new File( outputDir, 'pl-513/10' ).eachFileRecurse{ assert it.with{ directory || ( file &amp;&amp; name.endsWith( '.class'    )) }}
                                null == new File( outputDir, 'pl-513/11' ).eachFileRecurse{ assert it.with{ directory || ( file &amp;&amp; name.startsWith( '11-'     )) }}
                                null == new File( outputDir, 'pl-513/12' ).eachFileRecurse{ assert it.with{ directory || ( file &amp;&amp; name.endsWith( '-12.class' )) }}
                                null == new File( outputDir, 'pl-513/13' ).eachFileRecurse{ assert it.with{ directory || ( file &amp;&amp; name.with{ startsWith( '13-' ) &amp;&amp; endsWith( '-13.class' ) } ) }}
                                null == new File( outputDir, 'pl-513/14' ).eachFileRecurse{ assert it.with{ directory || ( file &amp;&amp; name.with{ startsWith( '14-' ) &amp;&amp; endsWith( '-14.14'    ) } ) }}

                                new File( outputDir, 'pl-513/15' ).listFiles().size() == 99
                                new File( outputDir, 'pl-513/15' ).listFiles().every{ it.with{ file &amp;&amp; name.with{ startsWith( '15-' ) &amp;&amp; endsWith( '-15.15' ) }}}

                                new File( outputDir, 'pl-513/16' ).listFiles().size() == 1
                            </assertGroovy>
                            <shouldFailAssertEqual>
                                ${outputDir}/pl-513/8|${outputDir}/pl-513/9
                                ${outputDir}/pl-513/10|${outputDir}/pl-513/11
                                ${outputDir}/pl-513/11|${outputDir}/pl-513/12
                                ${outputDir}/pl-513/10|${outputDir}/pl-513/12
                            </shouldFailAssertEqual>
                        </configuration>
                    </execution>
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <!-- http://evgeny-goldin.org/youtrack/issue/pl-502 -->
                    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
                    <execution>
                        <id>http://evgeny-goldin.org/youtrack/issue/pl-502</id>
                        <goals>
                            <goal>assert</goal>
                        </goals>
                        <phase>test</phase>
                        <configuration>
                            <assertEqual>
                                <!-- No replaces -->
                                ${outputDir}/pl-502/1|${outputDir}/pl-502/copy-2|**/*.class
                                ${outputDir}/pl-502/1|${outputDir}/pl-502/copy-2|**/*.xml
                                ${outputDir}/pl-502/copy-2|${outputDir}/pl-502/unpack-2|**/*.class
                                ${outputDir}/pl-502/copy-2|${outputDir}/pl-502/unpack-2|**/*.xml
                                ${outputDir}/pl-502/unpack-2|${outputDir}/pl-502/pack-2/unpack|**/*.class
                                ${outputDir}/pl-502/unpack-2|${outputDir}/pl-502/pack-2/unpack|**/*.xml
                                ${outputDir}/pl-502/pack-2/unpack|${outputDir}/pl-502/1|**/*.class
                                ${outputDir}/pl-502/pack-2/unpack|${outputDir}/pl-502/1|**/*.xml
                                <!-- Replaces -->
                                ${outputDir}/pl-502/copy-1|${outputDir}/pl-502/unpack-1
                                ${outputDir}/pl-502/unpack-1|${outputDir}/pl-502/pack-1/unpack
                                ${outputDir}/pl-502/pack-1/unpack|${outputDir}/pl-502/copy-1
                            </assertEqual>
                            <shouldFailAssertEqual>
                                <!-- Non-matching patterns -->
                                ${outputDir}/pl-502/1|${outputDir}/pl-502/copy-2|*.class
                                ${outputDir}/pl-502/1|${outputDir}/pl-502/copy-2|**/*.ppt
                                <!-- Replaced vs. non-replaced files -->
                                ${outputDir}/pl-502/copy-1|${outputDir}/pl-502/copy-2
                                ${outputDir}/pl-502/copy-1|${outputDir}/pl-502/copy-2|**/*.class
                                ${outputDir}/pl-502/unpack-1|${outputDir}/pl-502/unpack-2
                                ${outputDir}/pl-502/unpack-1|${outputDir}/pl-502/unpack-2|**/*.class
                                ${outputDir}/pl-502/pack-1/unpack|${outputDir}/pl-502/pack-2/unpack
                                ${outputDir}/pl-502/pack-1/unpack|${outputDir}/pl-502/pack-2/unpack|**/*.class
                            </shouldFailAssertEqual>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project>
